\documentclass[12pt]{article}
\usepackage{graphicx} 
\usepackage[spanish]{babel}
\usepackage{lmodern}
\renewcommand{\familydefault}{\sfdefault}
\usepackage{geometry}
\usepackage{setspace}
\usepackage{float}
\usepackage{xcolor}
\usepackage{amsmath}
\usepackage{tikz}

\usepackage[colorlinks=true, urlcolor=blue, linkcolor=black]{hyperref}

\begin{document}
\definecolor{azul}{RGB}{0, 168, 255}
\definecolor{azul2}{RGB}{7, 74, 163}

\begin{titlepage}
    \thispagestyle{empty}
    \newgeometry{left=2cm, right=1cm, top=2cm, bottom=2cm}
    
    % Gráfico de fondo corregido para ser fiable
    \begin{tikzpicture}[overlay, remember picture, fill opacity=0.7]
        \begin{scope}[shift={(current page.center)}]
            \rotatebox{-45}{\fill[azul2] (5, -15) rectangle (12, 15);}
            \rotatebox{-45}{\fill[azul] (3, -15) rectangle (5, 15);}
        \end{scope}
    \end{tikzpicture}
    
    \begin{spacing}{1.5}
        {\Huge \bfseries \noindent PRÁCTICA 5}
        \vspace{10pt}

        {\LARGE APLICACIÓN PARA GESTIÓN DE UNA LIBRERÍA}
        
        \vspace{1cm}
        
        {\Large Equipo:} \\
        {\Large Beltrán Saucedo Axel Alejandro} \\
        {\Large Cerón Samperio Lizeth Montserrat} \\
        {\Large Higuera Pineda Angel Abraham} \\
        {\Large Lorenzo Silva Abad Rey} \\
        {\Large 4BV1.}
    \end{spacing}
    
    \vspace{1.5cm}

    \begin{minipage}{7.5cm} % Ancho ajustado
        {\Large ESCUELA SUPERIOR DE CÓMPUTO}
    \end{minipage}

    \vfill % Empuja el contenido hacia el final de la página

    \begin{flushleft}
        {\Large \color{black}
        % Comando \textbf corregido con llaves
        \textbf{TECNOLOGÍAS PARA EL DESARROLLO DE APLICACIONES WEB}}
        
        \vspace{0.5cm}
        
        31/10/2025
    \end{flushleft}
    \vspace{1cm}
\end{titlepage}

\newpage
\tableofcontents
\newpage

\section{Introducción}
\subsection*{Planteamiento del problema}
Se busca crear una API web cuyo propósito sea gestionar un inventario y optimizar envíos con ayuda del algoritmo genético simple.
Para la gestión del inventario, se debe garantizar lo siguiente:
\begin{itemize}
    \item Permitir crear, leer, actualizar y borrar items, categorías y envíos en una base de datos.
\end{itemize}

Para la optimización de envíos, se debe garantizar lo siguiente:
\begin{itemize}
    \item Ofrecer un endpoint que utilice el AGS para resolver el problema de la mochila. Que calcule la combinación de items que maximiza la ganancia total de un envío sin exceder una capacidad de peso determinada.
\end{itemize}


\subsection*{Propuesta de solución}
La solución propuesta es el desarrollo de una API con FastAPI para la lógica de negocio y SQLModel para la gestión de la base de datos.
Componentes clave de la solución:
\begin{itemize}
    \item \textbf{SQLModel:} Para definir la estructura de la base de datos estableciendo categoría, item y envío como entidades principales.
    \item \textbf{endpoints (URLs):} Para crear, leer, actualizar y borrar items, categorías y envíos.
    \item \textbf{Algoritmo Génetico:} Realizará el calculo. Simulando un proceso de evolución para encontrar la mejor combinación de items que da la mayor ganancia total sin superar la capacidad.
\end{itemize}

\section{Fundamentos Teóricos}
En el desarrollo de esta práctica, se pondrán en uso conceptos y teconologías ya vistas; refinandolos de manera que sea entendible para el cliente, esto en forma de un inventario de biblioteca.


\subsection*{Entorno de Trabajo y Herramientas Principales}
\begin{itemize}
    \item \textbf{Python:} Es el lenguaje de programación sobre el que se construye toda la lógica de la aplicación. Su sencilla sintaxis y su amplia cantidad de librerías lo hacen ideal para el desarrollo web.\cite{ref2}
    \item \textbf{FastAPI:} Framework web moderno para construir APIs con Python. Sus características más destacadas son la rapidez, la validación de datos automática mediante Pydantic y la generación de documentación interactiva , que fue crucial para probar los endpoints de nuestra API.
    \item \textbf{Uvicorn:} Es un servidor ASGI ultrarrápido, utilizado para ejecutar la aplicación FastAPI. Permite que la API maneje múltiples peticiones de forma asíncrona, mejorando el rendimiento.\cite{ref3}
\end{itemize}

\subsection*{Persistencia de Datos}
La persistencia de datos es la capacidad de un sistema para poder conservar la información posterior de la duración de una sola ejecución. En nuestra practica pasada, los datos eran volátiles, ya que se almacenaban en una lista en memoria. En esta práctica, se implementa la persistencia a través de los siguientes componentes:

\begin{itemize}
    \item \textbf{SQLite:} Es un motor de base de datos relacional, autocontenido y que no requiere un servidor. Almacena toda la base de datos en un único archivo (en nuestro caso, \texttt{database.db}). Es ideal para desarrollo y aplicaciones de pequeña a mediana escala por su simplicidad y portabilidad.
    
    \item \textbf{SQLAlchemy:} Es una librería que funciona como un Mapeador Objeto-Relacional (ORM). Un ORM es una técnica que actúa como un "traductor" entre el código orientado a objetos y las tablas de una base de datos relacional. Permite manipular la base de datos utilizando código Python en lugar de escribir consultas SQL directamente.
    
    \item \textbf{SQLModel:} Es una librería que combina \textbf{SQLAlchemy} y \textbf{Pydantic}, creada por el mismo autor de FastAPI. Permite definir la estructura de los datos, las validaciones y el esquema de la base de datos en una sola clase, reduciendo la duplicación de código y simplificando el desarrollo. En nuestra práctica, las clases como \texttt{Item} son modelos de SQLModel que representan tanto la tabla en la base de datos como los datos que la API recibe y envía.\cite{ref4}
\end{itemize}

\subsection*{Relaciones en Bases de Datos}
\begin{itemize}
    \item \textbf{Relación Unívoca:} Cada valor de clave primaria se relaciona con sólo un registro en la tabla relacionada.
    \item \textbf{Uno a varios:} La tabla de claves primaria sólo contiene un registro que se relaciona con ninguno, uno o varios registros en la tabla relacionada.
    \item \textbf{Varios a varios:} Cada registro en ambas tablas puede estar relacionado con varios registros en la otra tabla. Este tipo de relaciones requieren una tercera tabla, denominada tabla de enlace o asociación, porque los sistemas relacionales no pueden alojar directamente la relación. \cite{ref5}
\end{itemize}

\subsection*{API CRUD}
Una API CRUD es una interfaz de programación que permite Crear, Leer, Actualizar y Borrar datos. \cite{ref6}

\subsection*{Búsqueda por parámetros.}
La búsqueda por parámetros consiste en consultar datos específicos en la base de datos utilizando ciertos "filtros" o "criterios". En la API se implementará mediante los endpoints:
\begin{itemize}
    \item \textbf{Libros del mismo autor.} Que permitirá obtener todos los libros escritos por un mismo autor.
    \item \textbf{Libros por categoría.} Que nos permitirá obtener todos los libros que pertenecen a una categoría específica.
    \item \textbf{Libros por serie.} Que nos permitirá obtener todos los libros pertenecientes a una serie.
    \item \textbf{Libros por público objetivo.} Que nos permitirá obtener los libros según el público al que van dirigidos.
\end{itemize}

\subsection*{Digitalización de un catálogo.}
Se trata de un proceso para la conversión de un catálogo de libros físicos a una búsqueda por consultas en un formato digital. 
Tomando en cuenta los siguientes aspectos de cada libro:
\begin{itemize}
   \item Titulo
   \item ISBN
   \item Autor(es)
   \item Editorial
   \item Año de publicación
   \item Páginas
   \item Categorías
   \item Precio
   \item Formato (físico o digital)
   \item Público objetivo (Mayores de edad o menores de edad)
   \item Serie (si pertenece a una serie de libros)
\end{itemize}
\section{Diagrama UML}
\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{Imagenes/uml1.png}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{Imagenes/uml2.png}
\end{figure}

\newpage
\section{Implementación}
\subsection*{Código:}
Para esta practica se nos solicito realizar una aplicacion encargada de gestionar una libreria, para lo cual se organizo el programa en varias carpetas, siguiendo la estructura que se nos dio en clase y con un orden basado en la importancia de cada archivo

\textbf{Arquitectura:}
\begin{itemize}
    \item \textbf{Modelos:} Define las tablas y relaciones en la base de datos utilizando SQLModel. 
    \item \textbf{Esquemas:} Define los modelos de datos y las reglas de validación.
    \item \textbf{Servicios:} Contiene la configuración y gestión de la base de datos.
    \item \textbf{Rutas:} Define los endpoints públicos de la API.
\end{itemize}
Para iniciar con el desarrollo de la aplicación, se creó el archivo principal \texttt{main.py}, que configura la aplicación FastAPI y monta los routers de las diferentes entidades (autores, editoriales, público objetivo y series).

Al tener el main para inicar con el programa, debemos continuar con la creacion de la base de datos que se encuentra en la carpeta \texttt{Servicios}, ya que sin esto no podriamos almacenar ningun dato.

\subsubsection*{\texttt{Servicios/database.py}: Gestión de la Base de Datos}
Este módulo es fundamental para la persistencia de datos.
\begin{itemize}
    \item \textbf{Configuración}: Establece la conexión con la base de datos. Se define la \texttt{DATABASE\_URL} para utilizar un archivo local de \textbf{SQLite} (\texttt{libreria.db}).
    \item \textbf{Motor (\texttt{engine})}: Se crea el \texttt{engine} (motor) de SQLModel, que sirve como el punto de acceso centralizado y el gestor de la comunicación entre la aplicación y la base de datos.
    \item \textbf{Gestión de Sesiones (\texttt{get\_session})}: Expone la función \texttt{get\_session} como una \textbf{dependencia} de FastAPI. Su responsabilidad es "inyectar" una sesión de base de datos activa en cada \textit{endpoint} que la requiera.
\end{itemize}

Al tener el "creador" de la base de datos, procedemos a definir la estructura de la misma, para lo cual se creo la carpeta \texttt{Modelos}.
\subsubsection*{\texttt{Modelos/modelos.py}: Definición de Tablas y Relaciones}
Este archivo es la dependenica cero del programa y la base de datos, es decir no podemos crear/escribir un servicio sin antes tener la estructura de la base de datos definida.

Más que nada este archivo se encarga de pasar la explicacion que se haria en una base de datos de cada tabla y sus relaciones a codigo python, para lo cual se utilizan las clases de \texttt{SQLModel}.

Dentro del archivo se encuentra la definicio de las tablas en modo de clases, donde cada clase representa una tabla en la base de datos y sus atributos representan las columnas de dicha tabla:
\begin{itemize}
    \item \textbf{LibroAutorLink}: Tabla de enlace para la relación muchos a muchos entre libros y autores.
    \begin{center}
        \includegraphics[width=0.9\textwidth]{Imagenes/modelo1-LibroAutorLink.png}
    \end{center}

    \item \textbf{LibroCategoriaLink}: Tabla de enlace para la relación muchos a muchos entre libros y categorías. 
    \begin{center}
        \includegraphics[width=0.9\textwidth]{Imagenes/modelo1-LibroCategoriaLink.png}
    \end{center}
    \newpage
    \item \textbf{Categoria}: Tabla para almacenar las categorías de los libros.
    \begin{center}
        \includegraphics[width=0.9\textwidth]{Imagenes/modelo1-categoria.png}
    \end{center}
    \item \textbf{Direccion}: Tabla para almacenar las direcciones de las editoriales.
    \begin{center}
        \includegraphics[width=0.9\textwidth]{Imagenes/modelo1-direccion.png}
    \end{center}
    \newpage
    \item \textbf{Editorial}: Tabla para almacenar las editoriales, con una relación uno a uno con \texttt{Direccion}.
    \begin{center}
        \includegraphics[width=0.9\textwidth]{Imagenes/modelo1-editorial.png}
    \end{center}
    \item \textbf{PublicoObjetivo}: Tabla para almacenar los públicos objetivo de los libros.
    \begin{center}
        \includegraphics[width=0.9\textwidth]{Imagenes/modelo1-publico.png}
    \end{center}
    \item \textbf{Serie}: Tabla para almacenar las series de libros.
    \begin{center}
        \includegraphics[width=0.9\textwidth]{Imagenes/modelo1-serie.png}
    \end{center}
    \newpage
    \item \textbf{Autor}: Tabla para almacenar los autores de los libros.
    \begin{center}
        \includegraphics[width=0.9\textwidth]{Imagenes/modelo1-autor.png}
    \end{center}
    \item \textbf{Libro}: Tabla principal para almacenar los libros, con relaciones muchos a muchos con \texttt{Autor} y \texttt{Categoria}, y relaciones uno a muchos con \texttt{Editorial}, \texttt{PublicoObjetivo} y \texttt{Serie}.
    En este caso la tabla \texttt{Libro} contiene claves foráneas que referencian a las tablas relacionadas.
    Además en el apartado de ISBN se especifica que es un campo único para evitar duplicados y se tiene una regla que permite crear de forma automática un ISBN si no se proporciona uno al crear un libro. Aunque esto no es una práctica común en el mundo real, se implementó como algo extra.
    \begin{center} 
        \includegraphics[width=0.9\textwidth]{Imagenes/modelo1-libro.png}
    \end{center}
\end{itemize}
\newpage

Una vez terminado el modelo de la base de datos, procedemos a definir los esquemas de datos que se utilizarán para validar las entradas y salidas de la API, para lo cual se creo la carpeta \texttt{Esquemas}.
\subsubsection*{\texttt{Esquemas/esquemas.py}: Definición de Modelos de Datos}

Este archivo define la estructura y las reglas de validación para todos los datos que maneja la API, utilizando las clases de \texttt{SQLModel}.
\begin{itemize}
    \item \textbf{\texttt{...Base} (Ej. \texttt{CategoriaBase})}: Define los atributos comunes y los tipos de datos de una entidad.
    \item \textbf{\texttt{...Crear} (Ej. \texttt{AutorCreacion})}: Esquemas utilizados para validar los datos JSON que \textbf{ingresan} a la API durante las operaciones de creación (\texttt{POST}).
    \item \textbf{\texttt{...Leer} (Ej. \texttt{AutorLeer})}: Esquemas que definen el formato de los datos que la API \textbf{devuelve} como respuesta. Comúnmente añaden el \texttt{id} generado por la BD.
    \item \textbf{\texttt{...Actualizar} (Ej. \texttt{EditorialActualizar})}: Esquemas específicos para operaciones \texttt{PATCH}, donde todos sus campos son \texttt{Optional} para permitir actualizaciones parciales.
\end{itemize}

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{Imagenes/Esquemas 1.png}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{Imagenes/Esquemas 2.png}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{Imagenes/Esquemas 3.png}
\end{figure}
\newpage

Para que el programa pueda interactuar con la base de datos, es necesario definir funciones que realicen las operaciones CRUD (Crear, Leer, Actualizar, Borrar) para cada entidad. Estas funciones se encuentran en la carpeta \texttt{Servicios}.

Es el apartado más extenso, ya que cada entidad tiene sus propias funciones CRUD, además de funciones adicionales para búsquedas específicas en el caso de los libros.
\subsubsection*{\texttt{Servicios/servicios,py}: Funciones CRUD}
Cada entidad tiene una función de busqueda por nombre, ID o mostrar todos.
El unico que llega a tener más funciones es el de libros, ya que tiene funciones para buscar por autor, categoria, serie, publico objetivo y todos los libros. \\
Las funciones más importantes son las de la entidad libro, ya que es el apartado principal del programa.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/servicios1.png}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{Imagenes/servicios62.png}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{Imagenes/servicios63.png}
\end{figure}
\newpage
Como se menciono la entidad libro es la más importante, por lo cual solo se mostara la funcion de creacion de libro:
\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{Imagenes/creacion_libro1.png}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{Imagenes/creacion_libro2.png}
\end{figure}



Al tener los esquemas de datos y sus funciones procedemos a definir los controladores de los endpoints de la API, para lo cual se creo la carpeta \texttt{Rutas}.
\subsubsection*{\texttt{Rutas/*.py}: Controladores de Endpoints de la API}

Estos archivos definen los \textit{endpoints} (URLs) públicos de la aplicación utilizando \texttt{APIRouter} de FastAPI para organizar las rutas de manera modular.
\begin{itemize}
    \item \textbf{\texttt{Rutas/autores.py}}: Establece el prefijo \texttt{/Autores} e implementa las operaciones \texttt{POST} (crear), \texttt{GET} (leer) y \texttt{DELETE} (eliminar) para los autores.
    \begin{center}
        \includegraphics[width=1\textwidth]{Imagenes/rutas_autores.png}
    \end{center}
    \newpage
    \item \textbf{\texttt{Rutas/editoriales.py}}: Gestiona el CRUD completo para \texttt{/Editoriales}, incluyendo la ruta \texttt{PATCH} para actualizaciones parciales y la lógica \texttt{DELETE} para borrar la editorial y su dirección.
    \begin{center}
        \includegraphics[width=0.8\textwidth]{Imagenes/rutas_Editora.png}
    \end{center}
    \newpage
    \item \textbf{\texttt{Rutas/publico\_objetivo.py} y \texttt{Rutas/series.py}}: Exponen las rutas \texttt{POST} y \texttt{GET} para crear y leer, respectivamente, las entidades de público objetivo y series.
    \begin{center}
        \includegraphics[width=1\textwidth]{Imagenes/rutas_publico.png}
    \end{center}
    \begin{center}
        \includegraphics[width=1\textwidth]{Imagenes/rutas_Series.png}
    \end{center}
    \newpage
    \item \textbf{\texttt{Rutas/categorias.py}}: Implementa el CRUD completo para \texttt{/Categorias}, similar a \texttt{editoriales.py}.
    \begin{center}
        \includegraphics[width=0.8\textwidth]{Imagenes/rutas_categorias.png}
    \end{center}
    \newpage
    \item \textbf{\texttt{Rutas/libros.py}}: El archivo más complejo y prisncipal de todos, maneja el CRUD completo para \texttt{/Libros} y define múltiples rutas \texttt{GET} para búsquedas específicas (por autor, categoría, serie y público objetivo).
    \begin{center}
        \includegraphics[width=1\textwidth]{Imagenes/rutas_libros1.png}
    \end{center}
    \begin{center}
        \includegraphics[width=1\textwidth]{Imagenes/rutas_libros2.png}
    \end{center}
    \begin{center}
        \includegraphics[width=1\textwidth]{Imagenes/rutas_libros3.png}
    \end{center}
    \begin{center}
        \includegraphics[width=1\textwidth]{Imagenes/rutas_libros4.png}
    \end{center}
\end{itemize}




\newpage % Opcional, para que las referencias empiecen en una página nueva

% Añade la línea "Referencias" al índice como si fuera una sección
\addcontentsline{toc}{section}{Referencias}
\begin{thebibliography}{99}

    \bibitem{ref1} IBM. (s.f.). ¿Qué es una API REST? Recuperado el 14 de octubre de 2025, de \url{https://www.ibm.com/mx-es/topics/rest-apis}
    \bibitem{ref2} Python Software Foundation. (s.f.). Acerca de Python™. Resumen Ejecutivo. Recuperado el 14 de octubre de 2025, de \url{https://www.python.org/doc/essays/blurb-es/}
    \bibitem{ref3} Ramírez, S. (s.f.). FastAPI. Recuperado el 14 de octubre de 2025, de \url{https://fastapi.tiangolo.com/es/}
    \bibitem{ref4} Ramírez, S. (s.f.). SQLModel. Recuperado el 14 de octubre de 2025, de \url{https://sqlmodel.tiangolo.com/es/}
    \bibitem{ref5} IBM Control Desk. (s. f.). Relaciones en Bases de Datos. Recuperado el 31 de octubre de 2025, de \url{ https://www.ibm.com/docs/es/control-desk/7.6.1?topic=structure-database-relationships}
    \bibitem{ref6} Jain, A. (2024, 8 septiembre). What is CRUD API? DEV Community. Recuperado el 31 de octubre de 2025, de \url{https://dev.to/ankitjaininfo/what-is-crud-api-502i}
    \bibitem{ref7} Tema 2. Algoritmos genéticos. (s. f.). Departamento de Ciencias de la Computación E Inteligencia Artificial. Recuperado el 31 de octubre de 2025, de \url{http://www.sc.ehu.es/ccwbayes/docencia/mmcc/docs/t2geneticos}

\end{thebibliography}

\end{document}